<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/png" sizes="96x96" href="/assets/icon.png">
    <link rel="shortcut icon" sizes="96x96" href="/assets/icon.png" />
    <link rel="stylesheet" type="text/css" href="/assets/style.css" />
    <script src="/assets/vanicom.min.js" defer></script>
    <script src="/assets/forge.js" defer></script>
    <script src="/assets/cypher.js" defer></script>
    <script src="/assets/qrcode.js" defer></script>
    <script src="/assets/runtime.js" defer></script>
    <script src="/assets/utils.js" defer></script>
    <script src="/assets/app.js" defer></script>
    <title>Wireguard Control</title>
</head>
<body>
    <div id="main-node">
      <h2>Wireguard Control</h2>
      <div class="infoblock">
        <div id="status-tab">
          <h3>Status</h3>
          <div id="error-block"><pre id="errors-code"></pre></div>
          <div id="status-block"></div>
        </div>
        <div id="config-tab" style="display: none;">
          <div id="config-details" class="text"></div>
          <section id="frontend-settings-panel" class="settings-card hidden">
            <h3>Настройки интерфейса</h3>
            <form id="frontend-settings-form">
              <label>DNS (через запятую)
                <input id="dns-input" type="text" placeholder="1.1.1.1, 1.0.0.1" />
              </label>
              <label>Новый frontendPasskey
                <input id="frontend-passkey-update" type="text" placeholder="Оставьте пустым, чтобы не менять" />
              </label>
              <label>Период обновления runtime (мин)
                <input id="runtime-rotation-input" type="number" min="1" value="5" />
              </label>
              <div class="form-actions">
                <button type="submit">Сохранить</button>
              </div>
            </form>
          </section>
        </div>
        <div class="menublock">
          <div class="buttonsblock">
            <button onclick="getStatus()">Status</button> &nbsp;
            <button onclick="getConfig()">Config</button> &nbsp;
            <button onclick="tryReboot()">Restart WG</button> &nbsp;
            <button onclick="addNewClient()">Add Client</button> &nbsp;
          </div>
          <div><fieldset id="ifaces-list"><legend>Выбор интерфейса</legend></fieldset></div>
          <div>
            Введите ключ для расшифровки данных:
            <input id="passkey-input" placeholder="Pass key" type="text" onkeyup="savePasskey()" />
          </div>
        </div>
      </div>
    </div>
    <div id="client-modal" class="modal hidden">
      <div class="modal__dialog">
        <button class="modal__close" onclick="closeClientModal()" aria-label="Close modal">×</button>
        <div id="client-modal-create">
          <h3>Создать клиента</h3>
          <form id="client-form">
            <label>Имя клиента
              <input id="client-name-input" type="text" placeholder="Client name" maxlength="120" />
            </label>
            <label>IP адрес (с CIDR)
              <input id="client-ip-input" type="text" placeholder="10.8.0.5/32" />
            </label>
            <label class="checkbox">
              <input id="client-download-checkbox" type="checkbox" checked />
              Автоматически скачать .conf после создания
            </label>
            <div class="modal__actions">
              <button type="submit">Создать</button>
            </div>
          </form>
          <div id="client-form-error" class="modal__error"></div>
        </div>
        <div id="client-modal-result" class="hidden">
          <h3>Конфигурация клиента</h3>
          <div id="client-result-meta" class="modal__meta"></div>
          <textarea id="client-config-preview" readonly rows="8"></textarea>
          <div id="client-qr"></div>
          <div class="modal__hint">QR содержит полный .conf, наведите камеру WireGuard клиента.</div>
          <div class="modal__actions">
            <button type="button" onclick="downloadClientConfig()">Скачать .conf</button>
            <button type="button" onclick="copyClientConfig()">Копировать</button>
            <button type="button" onclick="closeClientModal()">Закрыть</button>
          </div>
        </div>
      </div>
    </div>
</body>
</html>
