import{createCipheriv as d,createDecipheriv as g,randomBytes as i,scryptSync as h}from"crypto";const p="aes-256-gcm",c=12,f=16,T="wg-control::client-secret",b=t=>t.toString("base64"),l=t=>Buffer.from(t,"base64"),y=t=>{if(!t||t.length<8)throw new Error("Encryption passphrase must be at least 8 characters long.");return h(t,T,32)},S=(t,n)=>{const o=y(n),e=i(c),r=d(p,o,e),s=Buffer.concat([r.update(t,"utf8"),r.final()]),a=r.getAuthTag();return b(Buffer.concat([e,a,s]))},A=(t,n)=>{const o=y(n),e=l(t),r=e.subarray(0,c),s=e.subarray(c,c+f),a=e.subarray(c+f),u=g(p,o,r);return u.setAuthTag(s),Buffer.concat([u.update(a),u.final()]).toString("utf8")},v=(t=48)=>i(Math.ceil(t/2)).toString("hex").slice(0,t);export{A as decryptSecret,S as encryptSecret,v as generateRuntimeCode};
